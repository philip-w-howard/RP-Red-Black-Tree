#! /bin/bash
rm -f redblack.log
for SIZE in 64 65536; do
    for ACCESS in READ WRITE; do
        for ((ii=0; ii<4; ii++)); do
            for CPUS in `seq 1 16`; do
                for TEST in nolock lock rwl_read rwl_write rcu ; do
                    ./rb_$TEST $CPUS $ACCESS $SIZE >> redblack.log
                    echo "Iteration " $ii $TEST $CPUS $ACCESS $SIZE
                    who
                done
            done
        done
    done
done

awk -f decode.awk redblack.log >redblack.txt
parse <redblack.txt >redblack_p.txt

